params0: 0it [00:00, ?it/s]/home/sjabbour/.local/lib/python3.6/site-packages/sklearn/model_selection/_search.py:282: UserWarning: The total space of parameters 6 is smaller than n_iter=50. Running 6 iterations. For exhaustive searches, use GridSearchCV.
  % (grid_size, self.n_iter, grid_size), UserWarning)
params0: 6it [00:00, 50.46it/s]                               params0: 0it [00:00, ?it/s]params0: 6it [00:00, 52.64it/s]                               params0: 0it [00:00, ?it/s]                           pretrain_file 
model name: assumption_relaxation_bf_20_25
hyperparameters: {'lr': [0.01, 0.1, 0.001], 'batch_size': [32], 'augmentation': [['rotate']], 'momentum': [0.8, 0.9]}
Running multiple experiments, opening: /home/sjabbour/Chest/chest-x-ray/bias/data_resampling/data/assumption_relaxation/bf_20_25/pna_assumption_relaxation_1.p
CSV: pna_-1.00.csv
metadata: /home/sjabbour/Chest/chest-x-ray/bias/data_resampling/data/assumption_relaxation/bf_20_25/pna_-1.00.csv
EXPERIMENT: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00/
image.assumption_relaxation_bf_20_25 	 Run: 0 / 50
{'momentum': 0.8, 'lr': 0.01, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 1 / 50
{'momentum': 0.9, 'lr': 0.01, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 2 / 50
{'momentum': 0.8, 'lr': 0.1, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 3 / 50
{'momentum': 0.9, 'lr': 0.1, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 4 / 50
{'momentum': 0.8, 'lr': 0.001, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 5 / 50
{'momentum': 0.9, 'lr': 0.001, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-1.00//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
Took: 0.1196436882019043
CSV: pna_-0.20.csv
metadata: /home/sjabbour/Chest/chest-x-ray/bias/data_resampling/data/assumption_relaxation/bf_20_25/pna_-0.20.csv
EXPERIMENT: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20/
image.assumption_relaxation_bf_20_25 	 Run: 0 / 50
{'momentum': 0.8, 'lr': 0.01, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 1 / 50
{'momentum': 0.9, 'lr': 0.01, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 2 / 50
{'momentum': 0.8, 'lr': 0.1, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 3 / 50
{'momentum': 0.9, 'lr': 0.1, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 4 / 50
{'momentum': 0.8, 'lr': 0.001, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 5 / 50
{'momentum': 0.9, 'lr': 0.001, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_-0.20//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
Took: 0.11441683769226074
CSV: pna_0.70.csv
metadata: /home/sjabbour/Chest/chest-x-ray/bias/data_resampling/data/assumption_relaxation/bf_20_25/pna_0.70.csv
EXPERIMENT: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70/
image.assumption_relaxation_bf_20_25 	 Run: 0 / 50
{'momentum': 0.8, 'lr': 0.01, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 1 / 50
{'momentum': 0.9, 'lr': 0.01, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.01), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 2 / 50
{'momentum': 0.8, 'lr': 0.1, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 3 / 50
{'momentum': 0.9, 'lr': 0.1, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.1), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 4 / 50
{'momentum': 0.8, 'lr': 0.001, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.8)])_checkpoint.pth.tar
Already ran this, moving onto next
image.assumption_relaxation_bf_20_25 	 Run: 5 / 50
{'momentum': 0.9, 'lr': 0.001, 'batch_size': 32, 'augmentation': ['rotate']}
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_0/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.9)])_checkpoint.pth.tar
Already ran this, moving onto next
SAVENAME: ./checkpoint/synthetic/assumption_relaxation_bf_20_25//pna_0.70//seed_2/OrderedDict([('augmentation', ['rotate']), ('batch_size', 32), ('lr', 0.001), ('momentum', 0.9)])_checkpoint.pth.tar
Running trial: 2
Getting model
predicting ehr at: None
using pretrained densenet: yes
Pretrained densenet file: ./checkpoint/image/mimic_chexpert//seed_1/OrderedDict([('augmentation', ['rotate']), ('batch_size', 16), ('lr', 0.0001)])_checkpoint.pth.tar
Traceback (most recent call last):
  File "train.py", line 151, in <module>
    main()
  File "train.py", line 103, in main
    df_search = exp.run()
  File "/home/sjabbour/Chest/chest-x-ray/bias/experiment.py", line 71, in run
    results = self._run_trial(seed, params)
  File "/home/sjabbour/Chest/chest-x-ray/bias/experiment.py", line 106, in _run_trial
    self.model, criterion, optimizer = self._get_model(seed, params)
  File "/home/sjabbour/Chest/chest-x-ray/bias/experiment.py", line 241, in _get_model
    model = CNN_PACS(model_type, model_name, config(self.config_str + ".pretrain"), self.device, params, pretrain_file = self.pretrain_file).model.to(self.device)
  File "/home/sjabbour/Chest/chest-x-ray/bias/model/image_cnn.py", line 66, in __init__
    checkpoint = torch.load(pretrain_file)
  File "/home/sjabbour/.local/lib/python3.6/site-packages/torch/serialization.py", line 593, in load
    return _legacy_load(opened_file, map_location, pickle_module, **pickle_load_args)
  File "/home/sjabbour/.local/lib/python3.6/site-packages/torch/serialization.py", line 773, in _legacy_load
    result = unpickler.load()
  File "/home/sjabbour/.local/lib/python3.6/site-packages/torch/serialization.py", line 729, in persistent_load
    deserialized_objects[root_key] = restore_location(obj, location)
  File "/home/sjabbour/.local/lib/python3.6/site-packages/torch/serialization.py", line 178, in default_restore_location
    result = fn(storage, location)
  File "/home/sjabbour/.local/lib/python3.6/site-packages/torch/serialization.py", line 154, in _cuda_deserialize
    device = validate_cuda_device(location)
  File "/home/sjabbour/.local/lib/python3.6/site-packages/torch/serialization.py", line 138, in validate_cuda_device
    raise RuntimeError('Attempting to deserialize object on a CUDA '
RuntimeError: Attempting to deserialize object on a CUDA device but torch.cuda.is_available() is False. If you are running on a CPU-only machine, please use torch.load with map_location=torch.device('cpu') to map your storages to the CPU.
